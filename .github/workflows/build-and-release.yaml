name: Build and Release

on:
  push:
    tags:
      - v*

jobs:
  release:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Install goreleaser
        run: sudo snap install --classic goreleaser

      - name: Create snapshot
        run: goreleaser release --snapshot --clean

      - name: Validate release config
        run: goreleaser check

      - name: Release artfifacts
        run: goreleaser release
